<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONE - Crear Partida</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body class="login-page">

    <a class="back-button" href="index.html">
        <svg viewBox="0 0 24 24">
            <polyline points="15 18 9 12 15 6"></polyline>
        </svg>
    </a>

    <div class="floating-card"></div>
    <div class="floating-card"></div>
    <div class="floating-card"></div>
    <div class="floating-card"></div>

    <div class="container match-config-container">
        <h1 class="page-title">Crear Partida</h1>

        <div class="config-group">
            <label for="match-name" class="config-label">Nombre de la partida:</label>
            <input type="text" id="match-name" class="config-input" placeholder="Pelusas" value="Pelusas">
        </div>

        <!--<div class="config-group">
            <label for="player-count" class="config-label">Jugadores:</label>
            <div class="player-counter">
                <button type="button" class="counter-btn minus-btn">−</button>
                <span class="counter-display">3</span>
                <button type="button" class="counter-btn plus-btn">+</button>
            </div>
        </div>-->

        <div class="config-group radio-group">
            <label class="config-label">Tipo de Partida:</label>
            <div class="radio-option">
                <input type="radio" id="public" name="match-type" checked>
                <label for="public">Pública</label>
            </div>
            <div class="radio-option">
                <input type="radio" id="private" name="match-type">
                <label for="private">Privada</label>
            </div>
        </div>

        <div class="config-group radio-group">
            <label class="config-label">Reglas:</label>
            <div class="radio-option">
                <input type="radio" id="standard" name="rules" checked>
                <label for="standard">Standard</label>
            </div>
            <div class="radio-option">
                <input type="radio" id="broken-friendship" name="rules">
                <label for="broken-friendship">Rompe amistades</label>
            </div>
        </div>

        <input type="button" value="Crear" id="create" class="create-match-btn">

    </div>

    <!--<script src="script.js"></script>-->
    <script>
        const token = localStorage.getItem('jwtToken');
        if (!token) {
            window.location.href = 'login.html';
        }
        else {

            const headers = {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${token}`
            };





            document.getElementById('create').addEventListener('click', async (e) => {
                //e.preventDefault();

                //const submitButton = e.target.querySelector('button[type="submit"]');
                //const originalText = submitButton.textContent;
                console.log("xd");

                try {
                    //submitButton.textContent = 'Iniciando sesión...';
                    //submitButton.disabled = true;

                    const formData = {
                        Name: document.getElementById('match-name').value,
                        Private: document.getElementById('private').checked,
                        NewRules: document.getElementById('broken-friendship').checked
                    };
                    console.log(formData);
                    const response = await fetch('/api/Sessions/', {
                        method: 'POST',
                        headers,
                        body: JSON.stringify(formData)
                    });
                    console.log("xd");

                    if (response.ok) {
                        //    const token = await response.text();
                        //    localStorage.setItem('jwtToken', token);
                        window.location.href = 'crearpartida2.html';
                        //} else {
                        //    const emailInput = document.getElementById('email');
                        //    emailInput.setCustomValidity('Credenciales incorrectas');
                        //    emailInput.reportValidity();
                        //}
                    }
                } catch (error) {
                    //const emailInput = document.getElementById('email');
                    //emailInput.setCustomValidity('Error de conexión');
                    //emailInput.reportValidity();
                } finally {
                    //submitButton.textContent = originalText;
                    //submitButton.disabled = false;
                }
            });

            // Quitar mensaje validación al escribir
            //document.getElementById('email').addEventListener('input', function () {
            //    this.setCustomValidity('');
            //});
            //document.getElementById('password').addEventListener('input', function () {
            //    document.getElementById('email').setCustomValidity('');
            //});
        }
    </script>

</body>
</html>
